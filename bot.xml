<context>
  <input id="purchase" pattern="* blablableble *">
    <var name="RequestedOrder" value="javascript: $req_text.match(/\d{13}/) ? $req_text.match(/\d{13}/)[0] : null"/>
    <get url="http://factory.gocase.com.br/api/v1/zenbot/order_details" var="Data">
      <param name="email" value="$req_user_email"/>
    </get>

    <var name="OrderNumber" value="javascript: $Data.order.number"/>
    <var name="OrderShipped" value="javascript: $Data.order.shipped">
    <var name="OrderTrackingUrl" value="javascript: $Data.order.tracking_url">

    <context if='!$RequestedOrder and $OrderNumber and $OrderShipped and $OrderTrackingUrl'>
      <output>
        <![CDATA[
        <p>Here's the tracking link, you can check the status of the delivery directly from here $OrderTrackingUrl</p>
        <p>Your order number is $OrderNumber</p>
        ]]>
      </output>
    </context>

  </input>
</context>